
## CLAUDE.md

# ğŸ® My Chat Window Can Not Be A GalGame - AI ä¸Šä¸‹æ–‡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: 2.4 (è£å‰ªåŠŸèƒ½ + UI ä¼˜åŒ–)
**ç”Ÿæˆæ—¶é—´**: 2025-12-03
**é¡¹ç›®ç‰ˆæœ¬**: v0.91
**é¡¹ç›®ç±»å‹**: Python æ¡Œé¢åº”ç”¨ (Windows)
**æ ¸å¿ƒæŠ€æœ¯æ ˆ**: PyQt6, Pillow, keyboard, pywin32
**Python ç‰ˆæœ¬**: 3.10+

---

## ğŸ“‹ é¡¹ç›®æ„¿æ™¯

å°†èŠå¤©ä½“éªŒ GalGame åŒ–çš„é€šç”¨å·¥å…·ï¼Œå…è®¸ç”¨æˆ·åœ¨ä»»æ„èŠå¤©è½¯ä»¶ï¼ˆQQã€å¾®ä¿¡ã€Discord ç­‰ï¼‰ä¸­è¾“å…¥æ–‡å­—åï¼Œè‡ªåŠ¨æ¸²æŸ“æˆå¸¦æœ‰è§’è‰²ç«‹ç»˜ã€å¯¹è¯æ¡†çš„ç²¾ç¾å›¾ç‰‡ï¼Œ**ç²˜è´´åˆ°è¾“å…¥æ¡†åç”±ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤å‘é€**ã€‚

**æ ¸å¿ƒä»·å€¼**:

- ğŸš€ **è‡ªå®šä¹‰è§¦å‘**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è§¦å‘å¿«æ·é”®ï¼ˆé»˜è®¤ Enterï¼Œæ¨è Shift+Enterï¼‰
- ğŸ–¼ï¸ **é¢„è§ˆåå‘é€**: å›¾ç‰‡ç”Ÿæˆåç²˜è´´åˆ°è¾“å…¥æ¡†ï¼Œç”¨æˆ·ç¡®è®¤æ— è¯¯åæ‰‹åŠ¨æŒ‰ Enter å‘é€
- ğŸ­ **å®æ—¶è¡¨æƒ…åˆ‡æ¢**: Alt+1~9 å¿«æ·é”®åˆ‡æ¢è§’è‰²ç«‹ç»˜
- ğŸ¨ **è‡ªå®šä¹‰å­—ä½“**: æ”¯æŒä¸ºæ¯ä¸ªè§’è‰²é…ç½®ç‹¬ç«‹çš„ TrueType å­—ä½“
- âœ‚ï¸ **è‡ªå®šä¹‰è£å‰ª**: çµæ´»è£å‰ªè¾“å‡ºå›¾ç‰‡å°ºå¯¸ï¼Œæƒ³æ€ä¹ˆå‘å°±æ€ä¹ˆå‘
- ğŸ› ï¸ **å¯è§†åŒ–ç¼–è¾‘å™¨**: æ‰€è§å³æ‰€å¾—çš„è§’è‰²é…ç½®ä½“éªŒï¼Œæ ‡ç­¾é¡µåˆ†ç±»æ¸…æ™°
- âš¡ **é«˜æ€§èƒ½ç¼“å­˜**: é¢„å¤„ç†æœºåˆ¶ + å†…å­˜ç¼“å­˜ï¼Œç”Ÿæˆé€Ÿåº¦æå¿«
- ğŸ”„ **çƒ­é‡è½½é…ç½®**: Ctrl+F5 æ— éœ€é‡å¯å³å¯åº”ç”¨æ–°è®¾ç½®

---

## ğŸ—ï¸ æ¶æ„æ€»è§ˆ

```mermaid
graph TB
    subgraph "ç”¨æˆ·å…¥å£å±‚"
        A[main.py<br/>ä¸»ç¨‹åºå…¥å£]
        B[creator_gui.py<br/>ç¼–è¾‘å™¨å…¥å£]
    end

    subgraph "GUI æ¨¡å— (gui/)"
        C[MainWindow<br/>ä¸»çª—å£åè°ƒå™¨]
        D[AssetsPanel<br/>èµ„æºé¢æ¿]
        E[PropsPanel<br/>å±æ€§é¢æ¿]
        F[canvas/items<br/>å›¾å½¢é¡¹]
        G[widgets/*<br/>è‡ªå®šä¹‰æ§ä»¶]
        G2[hotkey_dialog<br/>å¿«æ·é”®è®¾ç½®]
        H[workers/*<br/>åå°ä»»åŠ¡]
    end

    subgraph "æ ¸å¿ƒå¼•æ“å±‚ (core/)"
        I[engine.py<br/>ä¸»å¼•æ“]
        J[listener.py<br/>é”®ç›˜ç›‘å¬<br/>+çƒ­é‡è½½]
        K[renderer.py<br/>å›¾åƒæ¸²æŸ“]
        L[clipboard.py<br/>å‰ªè´´æ¿]
        M[prebuild.py<br/>ç¼“å­˜é¢„ç”Ÿæˆ]
        N[utils.py<br/>é…ç½®ç®¡ç†]
    end

    subgraph "æ•°æ®å­˜å‚¨å±‚"
        O[(assets/characters/<br/>è§’è‰²æ•°æ®)]
        P[(assets/cache/<br/>é¢„æ¸²æŸ“ç¼“å­˜)]
        Q[(assets/pre_scaled/<br/>é¢„ç¼©æ”¾èƒŒæ™¯)]
        R[global_config.yaml<br/>+trigger_hotkey]
    end

    A --> I
    B --> C
    C --> D
    C --> E
    C --> F
    C --> G
    C --> G2
    C --> H
    C --> K
    C --> M
    I --> J
    I --> K
    I --> L
    J --> N
    K --> O
    K --> P
    M --> O
    M --> P
    M --> Q
    N --> R

    style A fill:#e3f2fd
    style B fill:#e3f2fd
    style C fill:#fff3e0
    style I fill:#f3e5f5
    style J fill:#f3e5f5
    style K fill:#f3e5f5
    style G2 fill:#c8e6c9
```

---

## ğŸ“¦ æ¨¡å—ç´¢å¼•

### ğŸ”¹ ç”¨æˆ·å…¥å£

| æ–‡ä»¶               | èŒè´£                      |
| ------------------ | ------------------------- |
| `main.py`        | è§’è‰²é€‰æ‹©ã€å¼•æ“å¯åŠ¨        |
| `creator_gui.py` | ç¼–è¾‘å™¨å¯åŠ¨å…¥å£ (çº¦ 20 è¡Œ) |

### ğŸ”¹ GUI æ¨¡å— (`gui/`)

| å­æ¨¡å—           | æ–‡ä»¶                           | èŒè´£                                               |
| ---------------- | ------------------------------ | -------------------------------------------------- |
| **å…¥å£**   | `__init__.py`                | æš´éœ² `MainWindow`                                |
| **å¸¸é‡**   | `constants.py`               | å…¨å±€å¸¸é‡ã€`CanvasConfig` ç®¡ç†å™¨                  |
| **ä¸»çª—å£** | `main_window.py`             | UI ç»„è£…ã€ä¸šåŠ¡åè°ƒã€è®¾ç½®èœå•                        |
| **ç”»å¸ƒ**   | `canvas/items.py`            | `ResizableTextItem`, `ScalableImageItem`       |
| **æ§ä»¶**   | `widgets/color_button.py`    | `ColorButton`                                    |
| **æ§ä»¶**   | `widgets/asset_list.py`      | `AssetListWidget`                                |
| **æ§ä»¶**   | `widgets/dialogs.py`         | `NewCharacterDialog`, `PrebuildProgressDialog` |
| **æ§ä»¶**   | `widgets/hotkey_dialog.py`   | `SettingsDialog`, `HotkeyEdit`                 |
| **é¢æ¿**   | `panels/assets_panel.py`     | å·¦ä¾§èµ„æºåº“é¢æ¿                                     |
| **é¢æ¿**   | `panels/props_panel.py`      | å³ä¾§å±æ€§é¢æ¿                                       |
| **åå°**   | `workers/prebuild_worker.py` | ç¼“å­˜ç”Ÿæˆçº¿ç¨‹                                       |

### ğŸ”¹ æ ¸å¿ƒå¼•æ“ (`core/`)

| æ–‡ä»¶             | æ ¸å¿ƒç±»/å‡½æ•°                                      | èŒè´£                                             |
| ---------------- | ------------------------------------------------ | ------------------------------------------------ |
| `engine.py`    | `GalGameEngine`                                | åè°ƒç›‘å¬å™¨ã€æ¸²æŸ“å™¨ã€å‰ªè´´æ¿ï¼Œ**ä¸è‡ªåŠ¨å‘é€** |
| `listener.py`  | `InputListener`                                | **å¯é…ç½®å¿«æ·é”®**ã€çƒ­é‡è½½ã€æš‚åœåˆ‡æ¢         |
| `renderer.py`  | `CharacterRenderer`                            | åŠ è½½èµ„æºã€åˆæˆå›¾åƒã€ç»˜åˆ¶æ–‡å­—                     |
| `clipboard.py` | `get_text()`, `set_image()`                  | Win32 å‰ªè´´æ¿è¯»å†™                                 |
| `prebuild.py`  | `prebuild_character()`                         | ç”Ÿæˆç«‹ç»˜Ã—èƒŒæ™¯ç»„åˆç¼“å­˜                           |
| `utils.py`     | `load_global_config()`, `normalize_layout()` | é…ç½®è¯»å†™ã€å¸ƒå±€å½’ä¸€åŒ–                             |

---

## ğŸ“‚ ç›®å½•ç»“æ„

```text
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ creator_gui.py              # ç¼–è¾‘å™¨å…¥å£ (ç²¾ç®€å ~30 è¡Œ)
â”œâ”€â”€ global_config.yaml          # å…¨å±€é…ç½® (å« trigger_hotkey)
â”‚
â”œâ”€â”€ gui/                        # GUI æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py             # æš´éœ² MainWindow
â”‚   â”œâ”€â”€ constants.py            # å¸¸é‡ä¸ CanvasConfig
â”‚   â”œâ”€â”€ main_window.py          # ä¸»çª—å£ (~550 è¡Œ)
â”‚   â”œâ”€â”€ canvas/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ items.py            # è‡ªå®šä¹‰å›¾å½¢é¡¹
â”‚   â”œâ”€â”€ widgets/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ color_button.py
â”‚   â”‚   â”œâ”€â”€ asset_list.py
â”‚   â”‚   â”œâ”€â”€ dialogs.py
â”‚   â”‚   â””â”€â”€ hotkey_dialog.py    # å¿«æ·é”®è®¾ç½®å¯¹è¯æ¡†
â”‚   â”œâ”€â”€ panels/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ assets_panel.py
â”‚   â”‚   â””â”€â”€ props_panel.py
â”‚   â””â”€â”€ workers/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ prebuild_worker.py
â”‚
â”œâ”€â”€ core/                       # æ ¸å¿ƒå¼•æ“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ engine.py               # â­ v2.2: ç§»é™¤è‡ªåŠ¨å‘é€
â”‚   â”œâ”€â”€ listener.py             # æ”¯æŒå¯é…ç½®å¿«æ·é”® + çƒ­é‡è½½
â”‚   â”œâ”€â”€ renderer.py
â”‚   â”œâ”€â”€ clipboard.py
â”‚   â”œâ”€â”€ prebuild.py
â”‚   â””â”€â”€ utils.py
â”‚
â””â”€â”€ assets/
    â”œâ”€â”€ characters/             # è§’è‰²æ•°æ®
    â”‚   â””â”€â”€ <char_id>/
    â”‚       â”œâ”€â”€ config.yaml     # è§’è‰²é…ç½®æ–‡ä»¶
    â”‚       â”œâ”€â”€ portrait/       # ç«‹ç»˜ç›®å½•
    â”‚       â”œâ”€â”€ background/     # èƒŒæ™¯ç›®å½•
    â”‚       â”œâ”€â”€ fonts/          # è‡ªå®šä¹‰å­—ä½“ç›®å½• (å¯é€‰)
    â”‚       â”‚   â””â”€â”€ custom.ttf
    â”‚       â””â”€â”€ textbox_bg.png  # å¯¹è¯æ¡†èƒŒæ™¯
    â”œâ”€â”€ common/
    â”‚   â”œâ”€â”€ fonts/
    â”‚   â”‚   â””â”€â”€ LXGWWenKai-Medium.ttf  # é»˜è®¤å­—ä½“
    â”‚   â””â”€â”€ background/         # å…¬å…±èƒŒæ™¯
    â”œâ”€â”€ cache/                  # é¢„æ¸²æŸ“ç¼“å­˜
    â”‚   â””â”€â”€ <char_id>/
    â”‚       â”œâ”€â”€ p_1__b_1.jpg
    â”‚       â””â”€â”€ _meta.json
    â””â”€â”€ pre_scaled/             # é¢„ç¼©æ”¾èƒŒæ™¯
        â””â”€â”€ characters/<char_id>/background/
```

---

## âŒ¨ï¸ å¿«æ·é”®ä½“ç³»

### ä¸»ç¨‹åºå¿«æ·é”® (main.py)

| å¿«æ·é”®                                | åŠŸèƒ½                        | è¯´æ˜                                |
| ------------------------------------- | --------------------------- | ----------------------------------- |
| **ç”¨æˆ·è‡ªå®šä¹‰** (é»˜è®¤ `enter`) | **ç”Ÿæˆå›¾ç‰‡å¹¶ç²˜è´´** â­ | å›¾ç‰‡ç²˜è´´åˆ°è¾“å…¥æ¡†ï¼Œéœ€æ‰‹åŠ¨ Enter å‘é€ |
| `Enter` (æ‰‹åŠ¨)                      | å‘é€å›¾ç‰‡                    | ç”¨æˆ·ç¡®è®¤åæ‰‹åŠ¨æŒ‰ä¸‹å‘é€              |
| `Alt + 1~9`                         | åˆ‡æ¢ç«‹ç»˜                    | åˆ‡æ¢åˆ°åˆ—è¡¨ä¸­çš„ç¬¬ 1~9 å¼ ç«‹ç»˜         |
| `Ctrl + F5`                         | **çƒ­é‡è½½é…ç½®**        | æ— éœ€é‡å¯åº”ç”¨æ–°çš„å¿«æ·é”®è®¾ç½®          |
| `Ctrl + F12`                        | æš‚åœ/æ¢å¤                   | ä¸´æ—¶æš‚åœæ‹¦æˆªåŠŸèƒ½                    |
| `Esc`                               | é€€å‡ºç¨‹åº                    | å®Œå…¨å…³é—­åå°ç›‘å¬                    |

### ç¼–è¾‘å™¨å¿«æ·é”® (creator_gui.py)

| å¿«æ·é”®       | åŠŸèƒ½               |
| ------------ | ------------------ |
| `Ctrl + N` | æ–°å»ºè§’è‰²           |
| `Ctrl + S` | ä¿å­˜é…ç½®           |
| `Ctrl + ,` | **æ‰“å¼€è®¾ç½®** |
| `Ctrl + R` | é‡è½½ç•Œé¢           |
| `F5`       | æ¸²æŸ“é¢„è§ˆ           |

---

## ğŸ”§ è‡ªå®šä¹‰å¿«æ·é”®åŠŸèƒ½

### è®¾è®¡èƒŒæ™¯

åŸæœ¬å›ºå®šä½¿ç”¨ `Enter` ä½œä¸ºè§¦å‘é”®ä¼šå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š

- å‘é€å›¾ç‰‡æ—¶è¯¯è§¦å‘ï¼ˆè¾“å…¥æ¡†ä¸ºç©ºæ—¶æŒ‰ Enterï¼‰
- æ— æ³•æ­£å¸¸æ¢è¡Œ
- ä¸æŸäº›èŠå¤©è½¯ä»¶çš„å¿«æ·é”®å†²çª

### è§£å†³æ–¹æ¡ˆ

æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è§¦å‘å¿«æ·é”®ï¼Œæ¨èä½¿ç”¨ `Shift+Enter` æˆ– `Ctrl+Enter`ï¼š

- **ç»„åˆé”®ä¸ä¼šæ‹¦æˆªåŸç”Ÿ Enter**ï¼Œä¿ç•™æ­£å¸¸å‘é€åŠŸèƒ½
- åªæœ‰æŒ‰ä¸‹ç»„åˆé”®æ—¶æ‰è§¦å‘"æ–‡å­—è½¬å›¾ç‰‡"

### é…ç½®æµç¨‹

```
1. æ‰“å¼€ GUI ç¼–è¾‘å™¨
   â””â”€ python creator_gui.py

2. æ‰“å¼€è®¾ç½®å¯¹è¯æ¡†
   â””â”€ æ–‡ä»¶ â†’ è®¾ç½® (Ctrl+,)

3. è®¾ç½®å¿«æ·é”®
   â”œâ”€ ç‚¹å‡»é¢„è®¾æŒ‰é’® (å¦‚ "Shift+Enter")
   â””â”€ æˆ–ç‚¹å‡»è¾“å…¥æ¡†æ‰‹åŠ¨å½•åˆ¶

4. ä¿å­˜è®¾ç½®
   â””â”€ ç‚¹å‡»"ä¿å­˜"æŒ‰é’®

5. åœ¨ main.py ä¸­åº”ç”¨
   â””â”€ æŒ‰ Ctrl+F5 çƒ­é‡è½½
   â””â”€ çœ‹åˆ°æç¤º: "ğŸ”„ è§¦å‘å¿«æ·é”®å·²æ›´æ–°: enter â†’ shift+enter"
```

### å®ç°æ¶æ„

```mermaid
graph LR
    A[SettingsDialog] -->|ä¿å­˜| B[global_config.yaml]
    B -->|trigger_hotkey| C[InputListener]
    D[Ctrl+F5] -->|reload_config| C
    C -->|åŠ¨æ€æ³¨å†Œ| E[keyboard.add_hotkey]
```

---

## ğŸ¨ GUI æ¨¡å—è¯¦è§£ (`gui/`)

### `widgets/hotkey_dialog.py`

#### `HotkeyEdit` - å¿«æ·é”®å½•åˆ¶è¾“å…¥æ¡†

```python
class HotkeyEdit(QLineEdit):
    """æ”¯æŒæŒ‰é”®å½•åˆ¶çš„è¾“å…¥æ¡†"""
    hotkeyChanged = pyqtSignal(str)  # å¿«æ·é”®å˜æ›´ä¿¡å·

    def keyPressEvent(self, event):
        # æ”¶é›†ä¿®é¥°é”® (Ctrl/Alt/Shift)
        # è·å–ä¸»é”®åç§°
        # ç»„åˆæˆ "ctrl+shift+enter" æ ¼å¼
        # å‘å°„ hotkeyChanged ä¿¡å·
```

**é”®åè½¬æ¢**: Qt é”®ç  â†’ keyboard åº“å…¼å®¹åç§°

```python
key_map = {
    Qt.Key.Key_Return: "enter",
    Qt.Key.Key_Space: "space",
    Qt.Key.Key_F1: "f1",
    # ...
}
```

#### `SettingsDialog` - è®¾ç½®å¯¹è¯æ¡†

```python
class SettingsDialog(QDialog):
    """å¿«æ·é”®è®¾ç½®å¯¹è¯æ¡†"""

    def _init_ui(self):
        # å¿«æ·é”®è¾“å…¥åŒºåŸŸ
        self.hotkey_edit = HotkeyEdit()
  
        # é¢„è®¾æŒ‰é’®: Enter / Ctrl+Enter / Shift+Enter / Alt+S
  
        # ä½¿ç”¨è¯´æ˜æç¤º
  
        # ä¿å­˜/å–æ¶ˆæŒ‰é’®

    def _save_and_close(self):
        # éªŒè¯å¿«æ·é”®æœ‰æ•ˆæ€§
        # æ£€æŸ¥æ˜¯å¦ä¸ç³»ç»Ÿå¿«æ·é”®å†²çª
        # ä¿å­˜åˆ° global_config.yaml
```

### `main_window.py` å˜æ›´

æ–°å¢èœå•é¡¹å’Œæ–¹æ³•ï¼š

```python
# _create_menus() ä¸­æ–°å¢:
action_settings = QAction("è®¾ç½® (&Settings)...", self)
action_settings.setShortcut("Ctrl+,")
action_settings.triggered.connect(self.open_settings)
file_menu.addAction(action_settings)

# æ–°å¢æ–¹æ³•:
def open_settings(self):
    """æ‰“å¼€è®¾ç½®å¯¹è¯æ¡†"""
    from .widgets import SettingsDialog
    dialog = SettingsDialog(self)
    dialog.exec()
```

---

## âš™ï¸ Core æ¨¡å—è¯¦è§£ (`core/`)

### `utils.py` - é…ç½®ç®¡ç†

```python
GLOBAL_CONFIG_FILENAME = "global_config.yaml"
LEGACY_GLOBAL_CONFIG_FILENAME = "global_config.json"

DEFAULT_CONFIG: Dict[str, Any] = {
    "current_character": "yuraa",
    "trigger_hotkey": "enter",  # è§¦å‘å¿«æ·é”®
    "global_hotkeys": {
        "copy_to_clipboard": "ctrl+shift+c",
        "show_character": "ctrl+shift+v",
    },
    "render": {
        "cache_format": "jpeg",
        "jpeg_quality": 90,
        "use_memory_canvas_cache": True
    }
}
```

**æ ¸å¿ƒå‡½æ•°**:
- `load_global_config()`ï¼šåŠ è½½ `global_config.yaml`ï¼ˆè‡ªåŠ¨å…¼å®¹æ—§çš„ JSON æ ¼å¼ï¼‰
- `save_global_config()`ï¼šä¿å­˜é…ç½®åˆ° YAML æ–‡ä»¶
- `normalize_style()`ï¼šä¸ºæ¯ä¸ªè§’è‰²çš„ `style` å­—æ®µè¡¥é½ `mode`ã€`text_wrapper`ã€`basic`ã€`advanced` ç»“æ„ï¼Œå…¼å®¹æ—§ç‰ˆ `font_size/name_color` å†™æ³•ï¼Œå¹¶è‡ªåŠ¨å¤„ç†å°è¯å‰åç¼€ä¸é«˜çº§åå­—é…ç½®ã€‚

### `engine.py` - ä¸»å¼•æ“ (v2.2 æ›´æ–°) â­

#### æ ¸å¿ƒå˜æ›´ï¼šç§»é™¤è‡ªåŠ¨å‘é€

```python
def _on_submit(self):
    # 1. æ¨¡æ‹Ÿ Ctrl+A å…¨é€‰, Ctrl+X å‰ªåˆ‡
    keyboard.send("ctrl+a")
    time.sleep(0.05)
    keyboard.send("ctrl+x")
    time.sleep(0.1)

    # 2. è·å–å‰ªè´´æ¿æ–‡æœ¬
    text = get_text().strip()

    if not text:
        print("ğŸ”• å‰ªè´´æ¿ä¸ºç©ºæˆ–éæ–‡æœ¬ï¼Œå°è¯•è¿˜åŸ...")
        keyboard.send("ctrl+v")
        return

    print(f"ğŸ“ æ•è·æ–‡æœ¬: {text}")

    # 3. æ¸²æŸ“å›¾ç‰‡
    try:
        image = self.renderer.render(text, self.current_expression)
    except Exception as e:
        # ... é”™è¯¯å¤„ç† ...

    # 4. å°†å›¾ç‰‡å†™å…¥å‰ªè´´æ¿å¹¶ç²˜è´´ï¼ˆä¸è‡ªåŠ¨å‘é€ï¼‰
    if set_image(image):
        time.sleep(0.1)
        keyboard.send("ctrl+v")
        # â­ v2.2: ç§»é™¤è‡ªåŠ¨å‘é€ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤
        # æ—§ä»£ç : time.sleep(1); keyboard.press_and_release("enter")
        print("âœ… å›¾ç‰‡å·²ç²˜è´´åˆ°è¾“å…¥æ¡†ï¼Œè¯·æŒ‰ Enter å‘é€")
    else:
        print("âŒ å›¾ç‰‡å†™å…¥å‰ªè´´æ¿å¤±è´¥")
        if set_text(text):
            keyboard.send("ctrl+v")
```

### `listener.py` - é”®ç›˜ç›‘å¬

#### æ ¸å¿ƒåŠŸèƒ½

```python
class InputListener:
    def __init__(self):
        config = load_global_config()
  
        # è¯»å–å¯é…ç½®çš„è§¦å‘å¿«æ·é”®
        self.trigger_hotkey: str = config.get("trigger_hotkey", "enter").lower().strip()
  
        # åˆ¤æ–­æ˜¯å•é”®è¿˜æ˜¯ç»„åˆé”®ï¼ˆå½±å“ suppress è¡Œä¸ºï¼‰
        self._is_single_key = "+" not in self.trigger_hotkey
```

#### å¿«æ·é”®æ³¨å†Œé€»è¾‘

```python
def _register_trigger_hotkey(self):
    """æ³¨å†Œè§¦å‘å¿«æ·é”®"""
    # å•é”®ï¼ˆå¦‚ enterï¼‰éœ€è¦ suppress=True æ¥æ‹¦æˆª
    # ç»„åˆé”®ï¼ˆå¦‚ ctrl+enterï¼‰ä¸éœ€è¦ suppress
    suppress = self._is_single_key
    self.trigger_hotkey_handle = keyboard.add_hotkey(
        self.trigger_hotkey, 
        self._trigger_submit, 
        suppress=suppress
    )
```

#### çƒ­é‡è½½åŠŸèƒ½

```python
def reload_config(self):
    """Ctrl+F5 è§¦å‘çš„çƒ­é‡è½½"""
    config = load_global_config()
    new_hotkey = config.get("trigger_hotkey", "enter").lower().strip()

    if new_hotkey != self.trigger_hotkey:
        # å–æ¶ˆæ—§å¿«æ·é”®
        self._unregister_trigger_hotkey()
  
        # æ›´æ–°é…ç½®
        self.trigger_hotkey = new_hotkey
        self._is_single_key = "+" not in self.trigger_hotkey
  
        # æ³¨å†Œæ–°å¿«æ·é”®
        self._register_trigger_hotkey()
  
        print(f"ğŸ”„ è§¦å‘å¿«æ·é”®å·²æ›´æ–°: {old} â†’ {new_hotkey}")
```

---

## ğŸ“„ é…ç½®æ–‡ä»¶ç»“æ„

### `global_config.yaml`

```yaml
current_character: yuraa          # ç¼–è¾‘å™¨å¯åŠ¨æ—¶é»˜è®¤é€‰æ‹©çš„è§’è‰²
trigger_hotkey: shift+enter       # æ§åˆ¶å°æ¨¡å¼ä¸‹è§¦å‘å›¾ç‰‡ç”Ÿæˆçš„å¿«æ·é”®
global_hotkeys:
  copy_to_clipboard: ctrl+shift+c # æ§åˆ¶å°æ¨¡å¼: å¤åˆ¶æœ€åä¸€å¼ å›¾åˆ°å‰ªè´´æ¿
  show_character: ctrl+shift+v    # æ§åˆ¶å°æ¨¡å¼: æ˜¾ç¤º/éšè—è§’è‰²çª—å£
render:
  cache_format: jpeg              # é¢„æ„å»ºç¼“å­˜æ ¼å¼ï¼šjpeg / png
  jpeg_quality: 90                # cache_format ä¸º jpeg æ—¶ä½¿ç”¨çš„è´¨é‡
  use_memory_canvas_cache: true   # æ˜¯å¦åœ¨å†…å­˜ç¼“å­˜ç”»å¸ƒï¼Œå‡å°‘ IO
```

> æ³¨æ„ï¼šé…ç½®æ–‡ä»¶å·²ä» JSON æ ¼å¼è¿ç§»åˆ° YAML æ ¼å¼ï¼Œä»£ç ä¼šè‡ªåŠ¨å…¼å®¹æ—§çš„ `global_config.json` æ–‡ä»¶ã€‚
> ç”»å¸ƒåˆ†è¾¨ç‡æ”¹ç”±å„è§’è‰² `config.json` ä¸­çš„ `layout._canvas_size` æ§åˆ¶ï¼Œåˆ‡æ¢è§’è‰²æ—¶ä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”åˆ†è¾¨ç‡ã€‚

### è§’è‰² `style` ç»“æ„ (`assets/characters/<id>/config.yaml`)

```yaml
style:
  mode: advanced                    # åç§°æ ·å¼æ¨¡å¼: basic / advanced
  font_file: fonts/lolita.ttf       # è‡ªå®šä¹‰å­—ä½“è·¯å¾„ (å¯é€‰ï¼Œç›¸å¯¹äºè§’è‰²ç›®å½•)
  text_wrapper:
    type: preset                    # å°è¯å‰åç¼€ç±»å‹: none / preset / custom
    preset: corner_double           # é¢„è®¾ç±»å‹: corner_single (ã€Œã€) / corner_double (ã€ã€)
    prefix: "ã€"
    suffix: "ã€"
  basic:
    font_size: 40
    text_color: [255, 255, 255]
    name_font_size: 32
    name_color: [255, 85, 255]
  advanced:
    name_layers:
      warden:                       # ç‰¹å®šè§’è‰²åçš„é«˜çº§æ ·å¼
        - text: "å…¸"
          position: [0, 0]
          font_color: [195, 209, 231]
          font_size: 196
        - text: "ç‹±"
          position: [200, 100]
          font_color: [255, 255, 255]
          font_size: 92
        - text: "é•¿"
          position: [300, 50]
          font_color: [255, 255, 255]
          font_size: 147
      default:                      # é»˜è®¤æ ·å¼
        - text: "{name}"
          position: [0, 0]
          font_color: [255, 85, 255]
          font_size: 32
```

**æ ·å¼é…ç½®è¯´æ˜**:
- **è‡ªå®šä¹‰å­—ä½“** (v2.3 æ–°å¢): é€šè¿‡ `font_file` å­—æ®µæŒ‡å®šè§’è‰²ä¸“å±å­—ä½“ï¼Œè·¯å¾„ç›¸å¯¹äºè§’è‰²ç›®å½•ï¼ˆå¦‚ `fonts/lolita.ttf`ï¼‰ã€‚æœªè®¾ç½®æ—¶ä½¿ç”¨é»˜è®¤çš„éœé¹œæ–‡æ¥·å­—ä½“ã€‚
- **å°è¯å‰åç¼€**: GUI å±æ€§é¢æ¿æ–°å¢ã€Œå°è¯å‰åç¼€ã€ç»„åˆæ¡†ï¼Œå¯é€‰ `none` / ã€Œã€ã€Œã€ / ã€ã€ã€ã€ / è‡ªå®šä¹‰å‰åç¼€ï¼Œå¹¶ç›´æ¥å†™å…¥ `text_wrapper`ã€‚
- **é«˜çº§åç§°é…ç½®**: å‹¾é€‰"å¯ç”¨é«˜çº§åç§°é…ç½®"åä¼šå±•å¼€è¾“å…¥æ¡†ï¼Œå¯ç¼–è¾‘ `name_layers` å¹¶ç‚¹å‡»"åº”ç”¨é…ç½®"å³æ—¶ä¿å­˜ï¼Œæ¸²æŸ“å™¨ä¼šæŒ‰ç›¸å¯¹åæ ‡å åŠ å¤šå±‚æ–‡æœ¬ã€‚
- æ³¨æ„ï¼šæ ·å¼é…ç½®å­˜å‚¨åœ¨å„è§’è‰²çš„ `config.yaml` ä¸­ï¼Œè€Œéå…¨å±€é…ç½®æ–‡ä»¶ã€‚

### å¿«æ·é”®æ ¼å¼è¯´æ˜

| æ ¼å¼     | ç¤ºä¾‹                                       | è¯´æ˜               |
| -------- | ------------------------------------------ | ------------------ |
| å•é”®     | `enter`, `space`, `f1`               | éœ€è¦ suppress æ‹¦æˆª |
| ç»„åˆé”®   | `ctrl+enter`, `shift+enter`, `alt+s` | ä¸æ‹¦æˆªåŸç”ŸæŒ‰é”®     |
| å¤šä¿®é¥°é”® | `ctrl+shift+s`                           | æ”¯æŒå¤šä¸ªä¿®é¥°é”®ç»„åˆ |

---

## ğŸ”„ æ ¸å¿ƒå·¥ä½œæµ

### ä¸»ç¨‹åºæ¸²æŸ“æµç¨‹ (v2.2 æ›´æ–°) â­

```
main.py â†’ GalGameEngine
  â”œâ”€ ensure_character_cache()     # æ£€æŸ¥/ç”Ÿæˆç¼“å­˜
  â”œâ”€ CharacterRenderer(char_id)   # åˆå§‹åŒ–æ¸²æŸ“å™¨
  â””â”€ InputListener ç›‘å¬å¾ªç¯:
      â”œâ”€ æ³¨å†Œ trigger_hotkey (ä»é…ç½®è¯»å–)
      â”œâ”€ æ³¨å†Œ Ctrl+F5 â†’ reload_config()  # çƒ­é‡è½½
      â”œâ”€ æ³¨å†Œ Ctrl+F12 â†’ toggle_pause()
      â”œâ”€ æ³¨å†Œ Alt+1~9 â†’ åˆ‡æ¢è¡¨æƒ…
      â””â”€ trigger_hotkey è§¦å‘:
          â”œâ”€ Ctrl+A, Ctrl+X æå–æ–‡æœ¬
          â”œâ”€ renderer.render(text, portrait_key, bg_key)
          â”œâ”€ set_image(pil_img)      # å†™å…¥å‰ªè´´æ¿
          â”œâ”€ Ctrl+V ç²˜è´´å›¾ç‰‡åˆ°è¾“å…¥æ¡†
          â””â”€ â­ ç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨æŒ‰ Enter å‘é€
```

### ç”¨æˆ·æ“ä½œæµç¨‹ (v2.2)

```
1. ç”¨æˆ·åœ¨èŠå¤©è¾“å…¥æ¡†è¾“å…¥æ–‡å­—
2. æŒ‰ä¸‹è§¦å‘å¿«æ·é”® (é»˜è®¤ Enter æˆ–è‡ªå®šä¹‰)
3. ç¨‹åºè‡ªåŠ¨:
   â”œâ”€ å…¨é€‰å¹¶å‰ªåˆ‡æ–‡å­—
   â”œâ”€ æ¸²æŸ“æˆ GalGame é£æ ¼å›¾ç‰‡
   â””â”€ ç²˜è´´å›¾ç‰‡åˆ°è¾“å…¥æ¡†
4. â­ ç”¨æˆ·æ£€æŸ¥å›¾ç‰‡é¢„è§ˆ
5. â­ ç”¨æˆ·æ‰‹åŠ¨æŒ‰ Enter å‘é€
```

### å¿«æ·é”®è®¾ç½®æµç¨‹

```
GUI: SettingsDialog
  â”œâ”€ ç”¨æˆ·ç‚¹å‡» HotkeyEdit è¾“å…¥æ¡†
  â”œâ”€ keyPressEvent æ•è·æŒ‰é”®
  â”‚   â”œâ”€ æ”¶é›†ä¿®é¥°é”® (Ctrl/Alt/Shift)
  â”‚   â”œâ”€ è·å–ä¸»é”®åç§°
  â”‚   â””â”€ ç»„åˆæˆ "shift+enter" æ ¼å¼
  â”œâ”€ ç”¨æˆ·ç‚¹å‡»"ä¿å­˜"
  â”‚   â”œâ”€ éªŒè¯å¿«æ·é”®æœ‰æ•ˆæ€§
  â”‚   â”œâ”€ æ£€æŸ¥å†²çª (esc, ctrl+c, ctrl+v ç­‰)
  â”‚   â””â”€ save_global_config({"trigger_hotkey": "shift+enter"})
  â”‚       â””â”€ ä¿å­˜åˆ° global_config.yaml
  â””â”€ æç¤ºç”¨æˆ·æŒ‰ Ctrl+F5 åº”ç”¨

main.py: InputListener
  â”œâ”€ ç”¨æˆ·æŒ‰ Ctrl+F5
  â”œâ”€ reload_config() è¢«è°ƒç”¨
  â”‚   â”œâ”€ load_global_config()
  â”‚   â”œâ”€ æ¯”è¾ƒæ–°æ—§å¿«æ·é”®
  â”‚   â”œâ”€ _unregister_trigger_hotkey()
  â”‚   â””â”€ _register_trigger_hotkey() (ä½¿ç”¨æ–°å¿«æ·é”®)
  â””â”€ æ‰“å°: "ğŸ”„ è§¦å‘å¿«æ·é”®å·²æ›´æ–°: enter â†’ shift+enter"
```

---

## ğŸ¯ æ¨èå¿«æ·é”®é…ç½®

| å¿«æ·é”®          | ä¼˜ç‚¹           | ç¼ºç‚¹               | æ¨èåœºæ™¯                 |
| --------------- | -------------- | ------------------ | ------------------------ |
| `enter`       | æœ€è‡ªç„¶         | éœ€è¦ä¸¤æ¬¡ Enter     | ä¹ æƒ¯ç¡®è®¤åå‘é€           |
| `shift+enter` | ä¸å½±å“æ­£å¸¸å‘é€ | æŸäº›è½¯ä»¶ç”¨è¿™ä¸ªæ¢è¡Œ | **æ¨èå¤§å¤šæ•°ç”¨æˆ·** |
| `ctrl+enter`  | å®Œå…¨ç‹¬ç«‹       | éœ€è¦è®°ä½           | é¿å…æ‰€æœ‰å†²çª             |
| `alt+s`       | å®Œå…¨ç‹¬ç«‹       | ä¸å¤Ÿç›´è§‚           | ç‰¹æ®Šéœ€æ±‚                 |

---

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹

### å¼€å‘ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone <repo_url>
cd My_Chat_Window_Can_Not_Be_A_GalGame

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
.venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### é…ç½®è‡ªå®šä¹‰å¿«æ·é”®

```bash
# 1. è¿è¡Œç¼–è¾‘å™¨
python creator_gui.py

# 2. æ‰“å¼€è®¾ç½®: æ–‡ä»¶ â†’ è®¾ç½® (Ctrl+,)

# 3. é€‰æ‹© "Shift+Enter" å¹¶ä¿å­˜

# 4. è¿è¡Œä¸»ç¨‹åº
python main.py

# 5. æŒ‰ Ctrl+F5 åº”ç”¨æ–°å¿«æ·é”®
```

### é…ç½®è‡ªå®šä¹‰å­—ä½“ (v2.3 æ–°å¢)

```bash
# 1. è¿è¡Œç¼–è¾‘å™¨
python creator_gui.py

# 2. é€‰æ‹©è¦é…ç½®çš„è§’è‰²

# 3. åœ¨å³ä¾§å±æ€§é¢æ¿æ‰¾åˆ°"è‡ªå®šä¹‰å­—ä½“"
#    ç‚¹å‡»"é€‰æ‹©å­—ä½“æ–‡ä»¶..."

# 4. é€‰æ‹© .ttf å­—ä½“æ–‡ä»¶
#    å­—ä½“ä¼šè‡ªåŠ¨å¤åˆ¶åˆ° assets/characters/<è§’è‰²>/fonts/

# 5. ä¿å­˜é…ç½® (Ctrl+S)

# 6. é‡æ–°ç”Ÿæˆç¼“å­˜ (F5)
#    å·¥å…· â†’ ç”Ÿæˆç¼“å­˜

# 7. é¢„è§ˆæ•ˆæœ
#    å·¥å…· â†’ æ¸²æŸ“é¢„è§ˆ
```

---

## ğŸ”§ å¸¸è§å¼€å‘ä»»åŠ¡

### æ·»åŠ æ–°çš„å¿«æ·é”®é¢„è®¾

ç¼–è¾‘ `gui/widgets/hotkey_dialog.py`:

```python
presets = [
    ("Enter", "enter"),
    ("Ctrl+Enter", "ctrl+enter"),
    ("Shift+Enter", "shift+enter"),
    ("Alt+S", "alt+s"),
    ("F9", "f9"),  # æ–°å¢é¢„è®¾
]
```

### æ·»åŠ æ–°çš„ç³»ç»Ÿå¿«æ·é”®

ç¼–è¾‘ `core/listener.py` çš„ `start()` æ–¹æ³•:

```python
# æ·»åŠ æ–°çš„å…¨å±€å¿«æ·é”®
keyboard.add_hotkey("ctrl+f6", self.some_new_function)
```

### è°ƒè¯•å¿«æ·é”®é—®é¢˜

```python
# åœ¨ listener.py ä¸­æ·»åŠ è°ƒè¯•è¾“å‡º
def _trigger_submit(self):
    print(f"[DEBUG] è§¦å‘é”®: {self.trigger_hotkey}")
    print(f"[DEBUG] æ˜¯å¦å•é”®: {self._is_single_key}")
    print(f"[DEBUG] ç›®æ ‡çª—å£: {self.is_target_window_active()}")
```

---

## âš ï¸ å·²çŸ¥é™åˆ¶

1. **ä»…æ”¯æŒ Windows**: ä¾èµ– `win32clipboard`, `win32gui`
2. **éœ€è¦ç®¡ç†å‘˜æƒé™**: å…¨å±€é”®ç›˜é’©å­å¯èƒ½éœ€è¦ææƒ
3. **æ–‡æœ¬æ¢è¡Œ**: ç®€å•æŒ‰å­—ç¬¦å®½åº¦è®¡ç®—ï¼Œä¸æ”¯æŒå¤æ‚æ’ç‰ˆ
4. **ç¼“å­˜å ç”¨**: N ç«‹ç»˜ Ã— M èƒŒæ™¯ = NÃ—M å¼ å›¾ç‰‡
5. **å¿«æ·é”®å†²çª**: éƒ¨åˆ†ç»„åˆé”®å¯èƒ½è¢«ç³»ç»Ÿæˆ–å…¶ä»–è½¯ä»¶å ç”¨

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

### ä»£ç è§„æ¨¡ (v2.2)

| æ¨¡å—           | æ–‡ä»¶æ•° | è¯´æ˜                |
| -------------- | ------ | ------------------- |
| `gui/`       | 13     | å« hotkey_dialog.py |
| `core/`      | 6      | engine.py v2.2 æ›´æ–° |
| **æ€»è®¡** | 19+    | -                   |

### ç‰ˆæœ¬æ›´æ–°å†å²

| ç‰ˆæœ¬  | ä¸»è¦å˜æ›´                                                    |
| ----- | ----------------------------------------------------------- |
| v2.0  | GUI æ¨¡å—åŒ–é‡æ„                                              |
| v2.1  | è‡ªå®šä¹‰å¿«æ·é”®ã€çƒ­é‡è½½                                        |
| v2.2  | â­ ç§»é™¤è‡ªåŠ¨å‘é€ï¼Œæ”¹ä¸ºæ‰‹åŠ¨ç¡®è®¤å‘é€                           |
| v2.3  | ğŸ¨ è‡ªå®šä¹‰å­—ä½“æ”¯æŒã€YAML é…ç½®ä¼˜åŒ–                            |
| v2.4  | âœ‚ï¸ è‡ªå®šä¹‰è£å‰ªåŠŸèƒ½ã€æ ‡ç­¾é¡µ UI é‡æ„ã€é¦–æ¬¡æ˜¾ç¤ºä¼˜åŒ– (v0.91)    |

---

## ğŸ†• v2.4 æ–°å¢åŠŸèƒ½è¯¦è§£ (v0.91)

### âœ‚ï¸ è‡ªå®šä¹‰è£å‰ªåŠŸèƒ½

**é—®é¢˜èƒŒæ™¯**ï¼šæœ‰æ—¶å€™å¯¹è¯ä¸éœ€è¦å›¾ç‰‡å±•ç¤ºçš„é‚£ä¹ˆå¤§ï¼Œä¾‹å¦‚ 1200x1200 çš„èƒŒæ™¯ï¼Œå¯èƒ½åªæƒ³å‘é€ 300x1200 çš„å›¾ç‰‡ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šæ–°å¢è‡ªå®šä¹‰è£å‰ªåŒºåŸŸåŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·çµæ´»æ§åˆ¶æœ€ç»ˆè¾“å‡ºå›¾ç‰‡çš„å°ºå¯¸ã€‚

#### æ ¸å¿ƒç‰¹æ€§

1. **å¯è§†åŒ–è£å‰ªæ¡†**ï¼š
   - çº¢è‰²è™šçº¿æ¡†æ ‡è¯†è£å‰ªåŒºåŸŸ
   - æ”¯æŒæ‹–æ‹½ç§»åŠ¨å’Œè°ƒæ•´å¤§å°
   - å®æ—¶æ˜¾ç¤ºè£å‰ªåŒºåŸŸå°ºå¯¸

2. **éç ´åæ€§è£å‰ª**ï¼š
   - ç¼“å­˜ä¿å­˜å®Œæ•´å›¾ç‰‡
   - è£å‰ªåœ¨æ¸²æŸ“æ—¶åŠ¨æ€åº”ç”¨
   - å¯éšæ—¶è°ƒæ•´è£å‰ªåŒºåŸŸæ— éœ€é‡æ–°ç”Ÿæˆç¼“å­˜

3. **é…ç½®æŒä¹…åŒ–**ï¼š
   ```yaml
   layout:
     enable_crop: true
     crop_area: [450, 0, 750, 1200]  # [x1, y1, x2, y2]
   ```

#### ä½¿ç”¨æ–¹æ³•

1. åœ¨ GUI ç¼–è¾‘å™¨ä¸­åˆ‡æ¢åˆ° **ğŸ“ å¸ƒå±€** æ ‡ç­¾é¡µ
2. å‹¾é€‰"å¯ç”¨è£å‰ª"
3. ç‚¹å‡»"æ˜¾ç¤º/éšè—è£å‰ªæ¡†"
4. æ‹–æ‹½çº¢è‰²æ¡†è°ƒæ•´è£å‰ªåŒºåŸŸ
5. ä¿å­˜é…ç½®ï¼ˆCtrl+Sï¼‰

#### å®ç°ç»†èŠ‚

- **æ–°å¢æ–‡ä»¶**ï¼š`gui/canvas/items.py` ä¸­çš„ `CropAreaItem` ç±»
- **æ¸²æŸ“é€»è¾‘**ï¼š`core/renderer.py` ä¸­çš„ `_apply_crop()` æ–¹æ³•
- **é…ç½®ç®¡ç†**ï¼š`core/utils.py` ä¸­çš„ `normalize_layout()` æ”¯æŒè£å‰ªåŒºåŸŸ

---

### ğŸ¨ æ ‡ç­¾é¡µ UI é‡æ„

**é—®é¢˜èƒŒæ™¯**ï¼šå³ä¾§å±æ€§é¢æ¿å†…å®¹è¿‡å¤šï¼Œç”¨æˆ·éœ€è¦æ»šåŠ¨æŸ¥æ‰¾è®¾ç½®é¡¹ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šå°†å±æ€§é¢æ¿é‡æ„ä¸ºæ ‡ç­¾é¡µç»“æ„ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»ç»„ç»‡ã€‚

#### æ–°çš„æ ‡ç­¾é¡µç»“æ„

1. **ğŸ“‹ åŸºç¡€** - åŸºæœ¬é…ç½®
   - åŸºæœ¬ä¿¡æ¯ï¼ˆæ˜¾ç¤ºåç§°ï¼‰
   - ç”»å¸ƒè®¾ç½®ï¼ˆåˆ†è¾¨ç‡ï¼‰
   - å¯¹è¯æ¡†ï¼ˆæ›´æ¢åº•å›¾ï¼‰

2. **ğŸ¨ æ ·å¼** - å¤–è§‚è®¾ç½®
   - æ–‡å­—æ ·å¼ï¼ˆæ­£æ–‡/åå­—å¤§å°å’Œé¢œè‰²ï¼‰
   - è‡ªå®šä¹‰å­—ä½“
   - å°è¯å‰åç¼€

3. **ğŸ“ å¸ƒå±€** - ä½ç½®è°ƒæ•´
   - å¸ƒå±€å¾®è°ƒï¼ˆç«‹ç»˜è¦†ç›–å¯¹è¯æ¡†ï¼‰
   - è£å‰ªåŒºåŸŸï¼ˆæ–°å¢ï¼‰

4. **âš™ï¸ é«˜çº§** - é«˜çº§åŠŸèƒ½
   - å¤šå±‚åç§°æ•ˆæœï¼ˆè‰ºæœ¯å­—ï¼‰

#### æ”¹è¿›äº®ç‚¹

- âœ… æ¸…æ™°çš„åŠŸèƒ½åˆ†ç±»ï¼Œå¿«é€Ÿå®šä½è®¾ç½®
- âœ… æ¯ä¸ªæ ‡ç­¾é¡µç‹¬ç«‹æ»šåŠ¨ï¼Œç©ºé—´åˆ©ç”¨æ›´é«˜æ•ˆ
- âœ… å›¾æ ‡åŒ–æ ‡ç­¾ï¼Œä¸€ç›®äº†ç„¶
- âœ… æ¸è¿›å¼å¤æ‚åº¦ï¼Œä»ç®€å•åˆ°é«˜çº§

---

### ğŸ”§ é¦–æ¬¡æ˜¾ç¤ºä¼˜åŒ–

**é—®é¢˜èƒŒæ™¯**ï¼šç¬¬ä¸€æ¬¡æ‰“å¼€ç¼–è¾‘å™¨æ—¶ï¼Œç”»å¸ƒä¸­çš„å›¾ç‰‡æ˜¾ç¤ºåå°ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ  `showEvent` æ–¹æ³•ï¼Œåœ¨çª—å£é¦–æ¬¡æ˜¾ç¤ºæ—¶å»¶è¿Ÿè°ƒç”¨ `fit_view()`ã€‚

#### å®ç°æ–¹å¼

```python
def showEvent(self, event):
    """çª—å£æ˜¾ç¤ºäº‹ä»¶ - é¦–æ¬¡æ˜¾ç¤ºæ—¶å»¶è¿Ÿè°ƒæ•´è§†å›¾"""
    super().showEvent(event)
    if self._first_show:
        self._first_show = False
        # å»¶è¿Ÿ 100ms åè°ƒæ•´è§†å›¾ï¼Œç¡®ä¿çª—å£å·²å®Œå…¨æ˜¾ç¤º
        QTimer.singleShot(100, self.fit_view)
```

#### æ•ˆæœ

- âœ… ç¬¬ä¸€æ¬¡æ‰“å¼€ç¼–è¾‘å™¨æ—¶å›¾ç‰‡è‡ªåŠ¨æ­£ç¡®ç¼©æ”¾
- âœ… æ— éœ€æ‰‹åŠ¨åˆ‡æ¢è§’è‰²æˆ–é‡è½½ç•Œé¢
- âœ… ä¼˜é›…ä¸”ä¸å½±å“æ€§èƒ½

---

### ğŸ¯ å¤šå±‚åç§°æ•ˆæœä¼˜åŒ–

**é—®é¢˜èƒŒæ™¯**ï¼šåŸæœ‰çš„"é«˜çº§åç§° YAML"é…ç½®ç•Œé¢ç¹çï¼ŒåŠŸèƒ½å®šä½ä¸æ¸…æ™°ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šé‡æ–°è®¾è®¡ä¸º"å¤šå±‚åç§°æ•ˆæœ"ï¼Œæ˜ç¡®åŠŸèƒ½å®šä½ã€‚

#### æ”¹è¿›å†…å®¹

1. **æ›´æ¸…æ™°çš„å‘½å**ï¼š
   - "å¯ç”¨é«˜çº§åç§° YAML" â†’ "å¯ç”¨å¤šå±‚åç§°æ•ˆæœ"
   - æ˜ç¡®è¿™æ˜¯ç”¨äºå®ç°å¤šå±‚æ–‡å­—å åŠ çš„åŠŸèƒ½

2. **æ›´å¥½çš„è¯´æ˜**ï¼š
   ```
   ğŸ’¡ å¤šå±‚åç§°æ•ˆæœå¯ä»¥å®ç°å¤æ‚çš„æ–‡å­—å åŠ ï¼Œä¾‹å¦‚ï¼š
      â€¢ ä¸åŒå¤§å°çš„æ–‡å­—ç»„åˆ
      â€¢ æ¸å˜è‰²æ–‡å­—æ•ˆæœ
      â€¢ è‰ºæœ¯å­—æ’ç‰ˆ
   ```

3. **å®Œæ•´çš„ç¤ºä¾‹**ï¼š
   - Placeholder ä¸­æä¾›"å…¸ç‹±é•¿"è‰ºæœ¯å­—å®Œæ•´ç¤ºä¾‹
   - ç”¨æˆ·å¯ä»¥ç›´æ¥å‚è€ƒå’Œä¿®æ”¹

#### ä½¿ç”¨åœºæ™¯

- **æ™®é€šç”¨æˆ·**ï¼ˆ90%ï¼‰ï¼šä¸éœ€è¦å‹¾é€‰ï¼Œä½¿ç”¨åŸºç¡€çš„"åå­— (å¤§å°/è‰²)"å³å¯
- **é«˜çº§ç”¨æˆ·**ï¼ˆ10%ï¼‰ï¼šéœ€è¦å¤æ‚è‰ºæœ¯å­—æ•ˆæœæ—¶æ‰å‹¾é€‰ä½¿ç”¨

---

**ç»´æŠ¤è€…**: OuroChival-Shizue, makoMako, IzumiShizuki

**å¼€æºåè®®**: MIT
